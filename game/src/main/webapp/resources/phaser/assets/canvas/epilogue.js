
// -- user code here --

/* --- start generated code --- */

// Generated by  1.5.1 (Phaser v2.6.2)

/**
 * epilogue.
 */
function epilogue() {
	
	Phaser.State.call(this);
	
}

/** @type Phaser.State */
var epilogue_proto = Object.create(Phaser.State.prototype);
epilogue.prototype = epilogue_proto;
epilogue.prototype.constructor = epilogue;

epilogue.prototype.init = function () {
	
	this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
	this.scale.pageAlignHorizontally = true;
	this.scale.pageAlignVertically = true;
	this.stage.backgroundColor = '#000000';
	
};

var epi_text;
var epi_frame;
var epi_nobtn;
var epi_yesbtn;
var epi_scriptIndex = 0;
var epi_script=[
                "Hello! \nCould you \nlet me know \nwhere I can \nfind a \nconvenient store?"
                ,"With my pleasure!\nIt's on the corner."
                ];

epilogue.prototype.create = function () {
	epi_frame = this.add.sprite(-10.0, -4.0, '08_epp_wakeup');
	epi_frame.scale.setTo(0.40321325807740654, 0.4535453765710031);
	epi_frame.inputEnabled = true;
	epi_frame.input.useHandCursor = true;
	epi_frame.events.onInputDown.add(epi_onTap, this);
	
	/* 재생음악 변수 설정 */
	epi_bgm = this.add.audio('Epilog_bgm'); // 재생음악 지정
	epi_bgm.play(); 						// 배경음악 재생
	epi_bgm.loopFull(); 					// 배경음악 무한 루프
	
	/* 메세지 변수 설정 */
	epi_text = this.add.text(456.0, 126.0, "フアァァァァー", 
			{"font":"bold 50px Arial", fill: "#000000", align: "left"});
	epi_text.rotation = 50;
	
	/* 아니오 버튼 */
	epi_nobtn = this.game.add.button(350.0, 300.0, 'btn_nope', goBye, this, 0, 1, 0, 1);
	epi_nobtn.scale.setTo(0.5, 0.5);
	epi_nobtn.inputEnabled = true;
	epi_nobtn.visible = false;
	
	/* 네 버튼 */
	epi_yesbtn = this.game.add.button(265.0, 300.0, 'btn_yes', startNew, this, 0, 1, 0, 1);
	epi_yesbtn.scale.setTo(0.5, 0.5);
	epi_yesbtn.inputEnabled = true;
	epi_yesbtn.visible = false;
};

/* --- end generated code --- */
// -- user code here --

/* 화면 전환 함수 */
function epi_onTap(pointer, singleTap) {

    if (singleTap)
    {
        if (epi_frame.key === '08_epp_wakeup')
        {
        	epi_frame.loadTexture('09_epp_meetfor');
        	epi_text.rotation = 0;
        	epi_text.setText(epi_script[0]);
        	epi_text.reset(56.0, 136.0);
        	epi_text.fontSize = 35;
        }
        else if(epi_frame.key === '09_epp_meetfor')
        {
        	epi_frame.loadTexture('10_epp_ftfuture');
        	epi_text.reset(420.0, 85.0);
        	epi_text.setText(epi_script[1]);
        }
        else
        {
        	epi_frame.destroy(true);
        	epi_text.reset(this.game.world.centerX - 200, this.game.world.centerY - 200);
        	epi_text.setText("ゲームを最初から\nまたプレイしますか。");
        	epi_text.fill = '#ffffff';
        	epi_yesbtn.visible = true;
        	epi_nobtn.visible = true;
        }
    }
}

/* 예스 버튼 누르면 - 페이지 전환 함수 */
function startNew(){
	epi_bgm.pause(); 				// 배경음악 일시 정지
	epi_bgm.destroy(true); 			// 배경음악 삭제
	this.game.state.start("japanMap");
}

/* 노 버튼 누르면 - 페이지 전환 함수 */
function goBye(){
	epi_yesbtn.visible = false;
	epi_nobtn.visible = false;
	epi_text.reset(this.game.world.centerX - 250, this.game.world.centerY - 100);
	epi_text.setText("ありがとう！ヒーロー！\t- END -");
}

